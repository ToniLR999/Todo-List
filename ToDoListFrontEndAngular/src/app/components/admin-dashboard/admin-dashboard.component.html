<div class="admin-dashboard" *ngIf="isAdmin">
    <div class="dashboard-header">
      <h1>ğŸ”§ Panel de AdministraciÃ³n</h1>
      <div class="last-update">
        Ãšltima actualizaciÃ³n: {{ getLastUpdate() }}
      </div>
      <div class="optimization-status" *ngIf="!isLoading">
        <span class="status-indicator" [class]="isHighLoad ? 'high-load' : 'normal-load'">
          {{ isHighLoad ? 'âš ï¸ Alta Carga' : 'âœ… Carga Normal' }}
        </span>
        <span class="cache-info">
          ğŸ“¦ CachÃ©: {{ metricsCache?.size || 0 }} entradas
        </span>
      </div>
    </div>

    <!-- Indicador de carga -->
    <div class="loading-indicator" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>Cargando mÃ©tricas del sistema...</p>
    </div>

    <!-- Estado de la AplicaciÃ³n -->
    <div class="metric-card" *ngIf="!isLoading">
      <h3>ğŸ“± Estado de la AplicaciÃ³n</h3>
      <div class="metric-grid">
        <div class="metric-item">
          <span class="label">Estado:</span>
          <span class="value" [class]="metrics?.app?.status === 'UP' ? 'status-up' : 'status-down'">
            {{ metrics?.app?.status || 'N/A' }}
          </span>
        </div>
        <div class="metric-item">
          <span class="label">Uptime:</span>
          <span class="value">{{ formatUptime(metrics?.app?.uptime || 0) }}</span>
        </div>
        <div class="metric-item">
          <span class="label">Horario:</span>
          <span class="value">{{ metrics?.app?.schedule || 'N/A' }}</span>
        </div>
        <div class="metric-item">
          <span class="label">VersiÃ³n:</span>
          <span class="value">{{ metrics?.app?.version || 'N/A' }}</span>
        </div>
      </div>
    </div>

    <!-- MÃ©tricas de Memoria -->
    <div class="metric-card" *ngIf="!isLoading">
      <h3>ğŸ’¾ Memoria del Sistema</h3>
      <div class="metric-grid">
        <div class="metric-item">
          <span class="label">Usada:</span>
          <span class="value">{{ metrics?.memory?.used || 0 }} MB</span>
        </div>
        <div class="metric-item">
          <span class="label">MÃ¡xima:</span>
          <span class="value">{{ metrics?.memory?.max || 0 }} MB</span>
        </div>
        <div class="metric-item">
          <span class="label">Porcentaje:</span>
          <span class="value" [class]="getMemoryClass(metrics?.memory?.percentage || 0)">
            {{ metrics?.memory?.percentage?.toFixed(1) || '0.0' }}%
          </span>
        </div>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="metrics?.memory?.percentage || 0"></div>
      </div>
    </div>

    <!-- MÃ©tricas de CPU -->
    <div class="metric-card" *ngIf="!isLoading">
      <h3>âš¡ CPU</h3>
      <div class="metric-grid">
        <div class="metric-item">
          <span class="label">Uso:</span>
          <span class="value" [class]="getCpuClass(metrics?.cpu?.usage || 0)">
            {{ (metrics?.cpu?.usage || 0) * 100 }}%
          </span>
        </div>
        <div class="metric-item">
          <span class="label">Carga:</span>
          <span class="value">{{ metrics?.cpu?.load?.toFixed(2) || '0.00' }}</span>
        </div>
      </div>
    </div>

    <!-- Estado de Base de Datos -->
    <div class="metric-card" *ngIf="!isLoading">
      <h3>ğŸ—„ï¸ Base de Datos</h3>
      <div class="metric-grid">
        <div class="metric-item">
          <span class="label">Estado:</span>
          <span class="value" [class]="getDbClass(metrics?.database?.status || '')">
            {{ metrics?.database?.status || 'N/A' }}
          </span>
        </div>
        <div class="metric-item">
          <span class="label">Conexiones Activas:</span>
          <span class="value">{{ metrics?.database?.connections || '0' }}</span>
        </div>
        <div class="metric-item">
          <span class="label">Conexiones MÃ¡ximas:</span>
          <span class="value">{{ metrics?.database?.maxConnections || '0' }}</span>
        </div>
      </div>
    </div>

    <!-- Estado de Redis -->
    <div class="metric-card" *ngIf="!isLoading">
      <h3>ğŸ”´ Redis</h3>
      <div class="metric-grid">
        <div class="metric-item">
          <span class="label">Estado:</span>
          <span class="value" [class]="getRedisClass(metrics?.redis?.status || '')">
            {{ metrics?.redis?.status || 'N/A' }}
          </span>
        </div>
        <div class="metric-item">
          <span class="label">Operaciones:</span>
          <span class="value">{{ metrics?.redis?.operations || '0' }}</span>
        </div>
      </div>
    </div>

    <!-- Acciones de AdministraciÃ³n -->
    <div class="metric-card" *ngIf="!isLoading">
      <h3>âš™ï¸ Acciones</h3>
      <div class="action-buttons">
        <button class="btn btn-primary" (click)="refreshMetrics()" [disabled]="isLoading">
          ğŸ”„ Actualizar MÃ©tricas
        </button>
        <button class="btn btn-warning" (click)="clearCache()" [disabled]="isLoading">
          ğŸ—‘ï¸ Limpiar CachÃ©
        </button>
        <button class="btn btn-info" (click)="exportMetrics()" [disabled]="isLoading">
          ğŸ“Š Exportar Reporte
        </button>
        <button class="btn btn-secondary" (click)="showDiagnosticAlert()" [disabled]="isLoading">
          ğŸ” DiagnÃ³stico
        </button>
        <button class="btn btn-success" (click)="testEndpoints()" [disabled]="isLoading">
          ğŸ§ª Probar Endpoints
        </button>
        <button class="btn btn-dark" (click)="showPerformanceStats()" [disabled]="isLoading">
          ğŸš€ Rendimiento
        </button>
      </div>
    </div>
  </div>

  <div class="access-denied" *ngIf="!isAdmin">
    <h2> Acceso Denegado</h2>
    <p>No tienes permisos para acceder a esta secciÃ³n.</p>
    <p>Para acceder, usa: <code>/admin?token=admin123</code></p>
    <button class="btn btn-primary" (click)="goToLogin()">Ir al Login</button>
  </div>